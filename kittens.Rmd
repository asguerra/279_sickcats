---
title: "Sick Cats Project"
author: "Ana Sofia Guerra & Gabriel Runte"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Hello! Testing this. Try Comitting and pushing with a response to make sure we get the hang of this. 
 
```{r packages}
#install.packages("deSolve", dependencies = T)
library(deSolve)
require(deSolve)

library(tidyverse) #install.packages('tidyverse)
```
 
A time series simulation of the model by Oliveira NM & Hilker FM (2010), Modelling disease introduction as biological control of invasive predators to preserve endangered prey, **Bulletin of Mathematical Biology**, 72:444-468. 


# Written Paper

### Introduction
200 words, at least two references. 
 
## The Model

**1. Describe core model equations in words**

starts with Lotka-Volterra predation model:
$$
\begin{align}
\frac{d N}{dT}  &= rN(1-N/K)-\mu NP 
\newline
\newline
\frac{d P}{dT} &= a\mu NP-dP
\newline
\end{align}
$$
where:
N(T): population size of prey (birds)
P(T): population size of predators (cats)
T: time
*r*: per capita growth rate
*K*: carrying capacity
*mu*: predation rate (per capita and unit prey)
*d*: predator per-capita mortality rate
*a*: trophic conversion efficiency

...incorporating FIV, P = Susceptible + Infected (with no recovery or immunity), and there is only one stage of the illness (FIV). so:

$$
\begin{align}
\ P= S + I
\newline
\newline
\frac{d S}{dT}  &=  a\mu NP-dS-\theta(P) \frac{S I}{P}
\newline
\newline
\frac{d I}{dT} &= \theta(P) \frac{S I}{P}-dI-\delta I
\newline
\end{align}
$$
where: $$\theta(P) = \beta_{PM}$$ is the incidence is of proportionate mixing type if the contact rate between predator individuals in constant.

The incidence is of mass action type if the conact rate between predator individuals increases linearly with population size, $$\theta(P) = \beta_{PM} P$$


re-writing model equations, with i being disease prevalence: 
$$ i = I/(S+I) $$

They introduce dimensionless variables (in order to reduce the number of parameters), where:
$$ 
\begin{align}
B=N/K
\newline
C=P\mu /r
\newline
t=rT
\end{align}
$$
**so the main equations in the model are: **

$$
\begin{align}
\frac{d B}{dt}  &= B(1-B)-BC
\newline
\newline
\frac{d C}{dt}  &= eBC-mC-\alpha Ci
\newline
\newline
\frac{d i}{dt}  &= ([\Gamma(C) - \alpha] [1-i] - eB)i
\newline
\end{align}
$$
where

$$
\begin{align}
\Gamma (C)  &= \frac{\beta_{PM}}{r} = \sigma_{PM}
\newline
\newline
and
\newline
\newline
\Gamma (C)  &= \frac{\beta_{MA}}{\mu}C = \sigma_{MA}C
\newline
\end{align}
$$
for proportionate mixing and mass action transmission respectively. 

$$
\begin{align}
e  &= \frac{a \mu K}{r}
\newline
\newline
m  &= \frac{d}{r}
\newline
\newline
\alpha  &= \frac{\delta}{r}
\newline
\end{align}
$$

#### Coding the model

A time series simulation of the model by Oliveira NM & Hilker FM (2010), Modelling disease introduction as biological control of invasive predators to preserve endangered prey, **Bulletin of Mathematical Biology**, 72:444-468. 

In the case of this model, the authors introduced dimensionless parameters to simply the model and thus avoid making incorrect assumptions about unknown variables such as $$\mu$$, the predation rate, and **K**, the bird population carrying capacity, as well as initial population sizes for birds, cats, and FIV. 

Thus, a lot of our values below are classified as 'NaN' as they are not applied in the model, but do exist. 

```{r known.parameters}
#known model parameters
r <- 0.1 #bird growth rate
a <- 0.03 #trophic conversion efficiency
d <-  0.6 #(cat natural death rate) 
BPM <- 1.6 #constant contact rate
v <-  0.2 #virulence
```

```{r unknown.parameters}
K <- 200#some value here #bird carrying capacity
mu <- 0.004#some value #cat predation rate
#BMA <- #some value #contact rate2
N0 <- 60#some number
P0 <- 20#some number
i0 <- 0.1
```

```{r dimensionless.parameters}
e <- (a*mu*K)/r
m <- d/r
al <- v/r
B0 <- N0/K
C0 <- (P0*mu)/r
```



 So do we make the simulations of N divided by K, or just of B, or just of B? I guess it might not matter so long as we pick N0 and K and solve for N later?

```{r variables}
tset <- seq(from = 0, to = 60, length.out = 100)
B.sim <- NaN*tset #bird pop 
C.sim <- NaN*tset #cat pop 
i.sim <- NaN*tset #disease prevalence
B.sim[1]<-B0
C.sim[1]<-C0
i.sim[1]<-i0
```

```{r}
for(j in 2:length(tset)){
	dt <- tset[j]-tset[j-1]
	B <- B.sim[j-1] 
	C <- C.sim[j-1]
	i <- i.sim[j-1]
	dB<- B*(1-B)-(B*C)*dt
	dC <- ((e*B*C)-(m*C)-(al*C*i))*dt 
	di <- (((BPM/r) - al)*(1-i) - (e*B))*i
	B.sim[j] <- B + dB 
	C.sim[j] <- C + dC 
	i.sim[j] <- i + di 
}
```



```{r}
Bcol <- 'dodgerblue3'
Ccol <- 'coral'
icol <- 'darkgoldenrod4'


plot(x = tset, y = B.sim, type = 'l', col=Bcol, las = 1, lwd=2, xlab = 'Time', ylab = 'Number of Individuals', ylim = c(-1000,1000))
abline(h = 0)
lines(x = tset, y = C.sim, col = Ccol, lwd = 2)
lines(x = tset, y = i.sim, col = icol, lwd = 2)
legend(x = max(tset)*0.1, y = 20, legend=c('B','C','i'),lwd= 2, col=c(Bcol,Ccol,icol), horiz=TRUE)
```

Looks hella weird!

### Model Assumptions:
List model assumptions

### Variables and Parameters
Table of variables and parameters, meanings, units, and any values used in paper

```{r parameters.table, include=T}
#parameters.table <- data.frame("parameter" = c("r","K",paste($\mu$),"a","d",), "definition" = " ", "value" = , "units" =, stringsAsFactors = FALSE)
```

### Time Series
Show how outcomes differ as a function of interesting parameters. include caption. 

### Bifurcation diagram

## Extension Section

1. Describe a modification to the model - in words and in math

2. Illustrate effects of modiification with one figure 

### Discussion

1. 100 words + 2 references

2. Critique applicability/limitations

3. Interpret results - what is the ecological significance? 


