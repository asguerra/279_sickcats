---
title: "EEMB 279 Project"
subtitle: "Time Series"
author: "Gabe Runte and Ana Sofia Guerra"
date: "2/18/2020"
output: html_document
output: word_document
---
```{r packages, include=FALSE}
#install.packages("deSolve", dependencies = T)
library(deSolve)
require(deSolve)
library(tidyverse) #install.packages('tidyverse)
```
 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

A time series simulation of the model by Oliveira NM & Hilker FM (2010), Modelling disease introduction as biological control of invasive predators to preserve endangered prey, **Bulletin of Mathematical Biology**, 72:444-468. 

In the case of this model, the authors introduced dimensionless parameters to simply the model and thus avoid making incorrect assumptions about unknown variables such as $$\mu$$, the predation rate, and **K**, the bird population carrying capacity, as well as initial population sizes for birds, cats, and FIV. 

Thus, a lot of our values below are classified as 'NaN' as they are not applied in the model, but do exist. 
```{r}
##Variables
N.v <- NaN    ## population size for victims (birds)
N.p <- NaN    ## population size for predators (cats)
t.time.set <- seq(1, 200, length.out= 2000) ## time



##Parameter values##
K <- NaN            # carrying capacity               (will be estimated from dimensionless parameters)
u <- NaN            # predation rate                  (will be estimated from dimensionless parameters)
beta.ma <- NaN      # contact rate for mass action    (will be estimated from dimensionless parameters)    

r.v <- 0.1          # per capita growth rate of birds in the model
a <- 0.03           # trophic conversion efficiency of cats
d.p <- 0.6          # natural per capita death rate of cats
beta.pm <- 1.5      # contact rate for proportionate mixing
delta <- 0.2        # virulence

#core equations
B <- N.v/K
B.set <-seq(0, 1, length.out=20000)
C <- N.p*u/r.v
t.set <- r.v*t.time.set

#dimensionless parameters
sigma.pm <- beta.pm/r.v
sigma.pm.set <- seq(0,25, length.out = 20000)
sigma.ma <- beta.ma * C/u 
sigma.ma.set<- seq(0, 250, length.out = 20000)

#e <- alpha*u*K/r.v
e <- 10
e.set <- seq(0, 25, length.out = 20000)
m <- d.p/r.v
alpha <- delta/r.v

```



```{r}
B.simu1 <- NaN*t.set 
  B.simu1[1] <- .7
C.simu1 <- NaN*t.set
  C.simu1[1] <- .7
I.simu1 <- NaN*t.set
  I.simu1[1] <- .4

#for PM
for(i in 2:length(t.set)){
  dt <- t.set[i]-t.set[i-1]
  B <- B.simu1[i-1]
  C <- C.simu1[i-1]
  I <- I.simu1[i-1]
  
  dB <- (B*(1-B) -B*C) *dt
  dC <- (e*B*C - m*C - alpha*C*I )*dt
  dI <- (((sigma.pm - alpha)* (1-I) - e*B)*I) *dt
  
  B.simu1[i] <- B + dB
  C.simu1[i] <- C + dC
  I.simu1[i] <- I + dI
}

  
plot(t.set, B.simu1, type= "l", ylim= c(0, 1))  
lines(t.set,C.simu1,lwd=2,col='dodgerblue')
lines(t.set, I.simu1, lwd = 2, col= "coral3")
B.simu1
```

