---
title: "Sick Cats Project"
author: "Ana Sofia Guerra & Gabriel Runte"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include=TRUE)
```

Hello! Testing this. Try Comitting and pushing with a response to make sure we get the hang of this. 
 
```{r packages, include=FALSE}
#install.packages("deSolve", dependencies = T)
library(deSolve)
require(deSolve)
library(tidyverse) #install.packages('tidyverse)
```
 
A time series simulation of the model by Oliveira NM & Hilker FM (2010), Modelling disease introduction as biological control of invasive predators to preserve endangered prey, **Bulletin of Mathematical Biology**, 72:444-468. 


# Written Paper

### Introduction 
`Need to add a few more sentences to this intro to fill it out a bit more. Maybe on the fact that the paper iis a counter to the original paper by Courchamp and Sugihara, 1999.`
Island ecosystems are some of the most vulnerable to human impact (CITE). In particular, birds found on islands have been found to be negatively impacted by the introduction of predatory species to islands (CITE - Sax and Brown 2000?). In the Aleutian Islands, the indroduction of artic foxes to some islands led to a precipitous decline of ground-nesting seabird populations on these islands (Croll 2005). On various tropicial(?) islands, including ...[insert] and [insert], the introduction of domestic cats (**Felis catus**), has severly depleted native bird populations (CITE). As a result, finding ways to exterminate or controll populations of invasive cats have become of importance to wilidlife managers (CITE). 
Using introduced diseases as biological control has been proposed as a method to control populations of domestic cats on islands (but see Strong and Pemberton 2000). The Feline Immunodeficiency Virus (FIV) has been proposed as a potentially successful biological control agent given its high host-specificity, meaniing it is unlikely to infect other wildlife present on the island. The model developed by Oliveira and Hilker aims to show how the introduction of FIV to an island with introduced cats and native birds may affect both populatioiins and thus affect conservatioin outcomes for imperiled birds (Oliveira and Hilker 2010). 

## The Model

**1. Describe core model equations in words**

The authors provide a standard Lotka-Volterra predation model (eq. 1 & 2) to describe how a logistically growing bird population (N) with intrinsic growth rate **r** and carrying capacity **K** is decreased by predation by cats (P), with cats having an attack rate **a**, conversiioin efficiency $\mu$, and natural mortality rate **d** .

The introduction of FIV is then modeled by considering the total cat population (P) being split into susceptible (S) and infected (I) individuals, where the susceptible cat population is similar to the Lotka Volterra predator population (eq. 2), and decreases as cats are infected. The infected cat population (I), depends on FIV infectivity and cat-to-cat contact rate (**add theta value**) and decreases with both natural mortality and FIV-inflicted deaths due to virulence. 
Finding the correct values for the proposed parameters; however, proved to be complicated. 

Therefore, the authors provide a non-dimensional model in which we then examine [what is B in words?] (B), as ....equation in words.., [C in words] (C), as...., and i, as FIV prevalence (or proportion of infected cats). 

[describe non-dimensional equations]
$$
\begin{align}
\frac{d N}{dT}  &= rN(1-N/K)-\mu NP 
\newline
\newline
\frac{d P}{dT} &= a\mu NP-dP
\newline
\end{align}
$$
where:
N(T): population size of prey (birds)
P(T): population size of predators (cats)
T: time
*r*: per capita growth rate
*K*: carrying capacity
*mu*: predation rate (per capita and unit prey)
*d*: predator per-capita mortality rate
*a*: trophic conversion efficiency

...incorporating FIV, P = Susceptible + Infected (with no recovery or immunity), and there is only one stage of the illness (FIV). so:

$$
\begin{align}
\ P= S + I
\newline
\newline
\frac{d S}{dT}  &=  a\mu NP-dS-\theta(P) \frac{S I}{P}
\newline
\newline
\frac{d I}{dT} &= \theta(P) \frac{S I}{P}-dI-\delta I
\newline
\end{align}
$$
where: $$\theta(P) = \beta_{PM}$$ is the incidence is of proportionate mixing type if the contact rate between predator individuals in constant.

The incidence is of mass action type if the conact rate between predator individuals increases linearly with population size, $$\theta(P) = \beta_{PM} P$$


re-writing model equations, with i being disease prevalence: 
$$ i = I/(S+I) $$

They introduce dimensionless variables (in order to reduce the number of parameters), where:
$$ 
\begin{align}
B=N/K
\newline
C=P\mu /r
\newline
t=rT
\end{align}
$$
**so the main equations in the model are: **

$$
\begin{align}
\frac{d B}{dt}  &= B(1-B)-BC
\newline
\newline
\frac{d C}{dt}  &= eBC-mC-\alpha Ci
\newline
\newline
\frac{d i}{dt}  &= ([\Gamma(C) - \alpha] [1-i] - eB)i
\newline
\end{align}
$$
where

$$
\begin{align}
\Gamma (C)  &= \frac{\beta_{PM}}{r} = \sigma_{PM}
\newline
\newline
and
\newline
\newline
\Gamma (C)  &= \frac{\beta_{MA}}{\mu}C = \sigma_{MA}C
\newline
\end{align}
$$
for proportionate mixing and mass action transmission respectively. 

$$
\begin{align}
e  &= \frac{a \mu K}{r}
\newline
\newline
m  &= \frac{d}{r}
\newline
\newline
\alpha  &= \frac{\delta}{r}
\newline
\end{align}
$$

##Coding the model

In the case of this model, the authors introduced dimensionless parameters to simplify the model and thus avoid making incorrect assumptions about unknown variables such as $$\mu$$, the predation rate, and **K**, the bird population carrying capacity, as well as initial population sizes for birds, cats, and FIV. 

Thus, a lot of our values below are classified as 'NaN' as they are not applied in the model, but do exist. 

### Model Assumptions:
List model assumptions

### Variables and Parameters
Table of variables and parameters, meanings, units, and any values used in paper

```{r parameters.table, include=T}
#parameters.table <- data.frame("parameter" = c("r","K",paste($\mu$),"a","d",), "definition" = " ", "value" = , "units" =, stringsAsFactors = FALSE)
```

### Time Series
Show how outcomes differ as a function of interesting parameters. include caption. 
```{r var.params, include=TRUE}
##Variables
#N.v <- NaN    ## population size for victims (birds)
#N.p <- NaN    ## population size for predators (cats)
t.time.set <- seq(1, 200, length.out= 2000) ## time

##Parameter values##
#K <- NaN            # carrying capacity               (will be estimated from dimensionless parameters)
#u <- NaN            # predation rate                  (will be estimated from dimensionless parameters)
#beta.ma <- NaN      # contact rate for mass action    (will be estimated from dimensionless parameters)    

r.v <- 0.1          # per capita growth rate of birds in the model
a <- 0.03           # trophic conversion efficiency of cats
d.p <- 0.6          # natural per capita death rate of cats
beta.pm <- 1.5      # contact rate for proportionate mixing
delta <- 0.2        # virulence

#core equations
#B <- N.v/K
B.set <-seq(0, 1, length.out=20000)
#C <- N.p*u/r.v
t.set <- r.v*t.time.set

#dimensionless parameters
sigma.pm <- beta.pm/r.v
#sigma.pm.set <- seq(0,25, length.out = 20000)
#sigma.ma <- beta.ma * C/u 
#sigma.ma.set<- seq(0, 250, length.out = 20000)

#e <- alpha*u*K/r.v
e <- 10
#e.set <- seq(0, 25, length.out = 20000)
m <- d.p/r.v
alpha <- delta/r.v

```

```{r simu2, include=TRUE}

B.simu1 <- NaN*t.set 
  B.simu1[1] <- .3
C.simu1 <- NaN*t.set
  C.simu1[1] <- .75
I.simu1 <- NaN*t.set
 I.simu1[1] <- 0.2

#for PM
for(i in 2:length(t.set)){
  
  dt <- t.set[i]-t.set[i-1]
  B <- B.simu1[i-1]
  C <- C.simu1[i-1]
  I <- I.simu1[i-1]
  
  dB <- (B*(1-B) -B*C) *dt
  dC <- (e*B*C - m*C - alpha*C*I)*dt
  dI <- (((sigma.pm - alpha)* (1-I) - e*B)*I) *dt
  
  B.simu1[i] <- B + dB
  C.simu1[i] <- C + dC
  I.simu1[i] <- I + dI
}

B.simu2 <- NaN*t.set 
  B.simu2[1] <- .3
C.simu2 <- NaN*t.set
  C.simu2[1] <- .75
I.simu2 <- NaN*t.set
# I.simu2[1] <- 0

#for PM
for(i in 2:length(t.set)){
  
  	if(t.set[i] < 3){I.simu2[i-1] <- 0 } else { 
  	  if(t.set[i] == 3) {I.simu2[i-1] <- 0.2} else { I<- I.simu2[i-1]}}
	
  dt <- t.set[i]-t.set[i-1]
  B <- B.simu2[i-1]
  C <- C.simu2[i-1]
  #I.simu2[i-1]
  
  dB <- (B*(1-B) -B*C) *dt
  dC <- (e*B*C - m*C - alpha*C*I)*dt
  dI <- (((sigma.pm - alpha)* (1-I) - e*B)*I) *dt
  
  B.simu2[i] <- B + dB
  C.simu2[i] <- C + dC
  I.simu2[i] <- I + dI
}

plot(t.set, B.simu2, type= "l", ylim= c(0, 1), ylab="Population (dimensionless)", xlab="time (rT)") 
lines(t.set,C.simu2,lwd=2,col='dodgerblue')
lines(t.set, I.simu2, lwd = 2, col= "coral3")
legend(x=16,y=1, col = c("black","dodgerblue","coral3"), lty=1,lwd=2,legend = c("birds", "cats", "FIV"))
text(x=3.5, y=0.04, adj=0, label="FIV introduced")
```
*ADD A CAPTION FOR THE FIGURE*

### Bifurcation diagram
Bifurcation diagram with respect to ..... some parameter. Do we run into having to make dimensional again? Or do we just pick e? 


## Extension Section

1. Describe a modification to the model - in words and in math

2. Illustrate effects of modiification with one figure 

### Discussion

1. 100 words + 2 references

2. Critique applicability/limitations

3. Interpret results - what is the ecological significance? 


